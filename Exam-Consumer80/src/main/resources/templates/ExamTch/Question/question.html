<!DOCTYPE html ><html xmlns:v-bind="http://www.w3.org/1999/xhtml"><head>    <!-- 页面meta -->    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <title>题库管理</title>    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">    <!-- 引入样式 -->    <link rel="stylesheet" href="/static/ElementUI/index.css">    <link rel="stylesheet" href="/static/plugins/font-awesome/css/font-awesome.css">    <link rel="stylesheet" href="/static/css/ExamTch/Course/style.css"></head><body class="hold-transition"><div id="app">    <div class="content-header">        <h1>题库管理</h1>    </div>    <div class="app-container">        <div class="box">            <div class="filter-container">                <el-button type="primary" class="butT" @click="handleCreate()">新建</el-button>                <el-input placeholder="题号" v-model="pagination.id" style="width: 200px;" class="filter-item"></el-input>                <el-input placeholder="题目内容" v-model="pagination.question" style="width: 200px;" class="filter-item"></el-input>                <el-select placeholder="课程类别" v-model="pagination.courseId">                    <el-option                            v-for="item in courseList"                            :key="item.id"                            :label="item.name"                            :value="item.id">                    </el-option>                </el-select>                <el-select placeholder="出题人" v-model="pagination.teacherId">                    <el-option                            v-for="item in teacherList"                            :key="item.id"                            :label="item.name"                            :value="item.id">                    </el-option>                </el-select>                <el-button @click="getAll()" class="dalfBut">查询</el-button>                <el-button @click="resetSearchForm()">重置</el-button>            </div>            <el-table size="small" current-row-key="id" :data="dataList" stripe highlight-current-row>                <el-table-column prop="id" align="center" label="题号" width="50px"></el-table-column>                <el-table-column prop="question" label="题干" align="center"></el-table-column>                <el-table-column prop="analysis" label="解析" align="center"></el-table-column>                <el-table-column label="操作" align="center" width="150px">                    <template slot-scope="scope">                        <el-button type="primary" size="mini" @click="handleUpdate(scope.row)">编辑</el-button>                        <el-button type="danger" size="mini" @click="handleDelete(scope.row)">删除</el-button>                    </template>                </el-table-column>            </el-table>            <!--分页组件-->            <div class="pagination-container">                <el-pagination                        class="pagiantion"                        @current-change="handleCurrentChange"                        :current-page="pagination.currentPage"                        :page-size="pagination.pageSize"                        layout="total, prev, pager, next, jumper"                        :total="pagination.total">                </el-pagination>            </div>            <!-- 新增标签弹层 -->            <div class="add-form">                <el-dialog title="新增题目" :visible.sync="dialogFormVisible">                    <el-form ref="dataAddForm" :model="formData" :rules="rules" label-position="right" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="所属课程：" prop="courseId">                                    <el-select v-model="formData.courseId">                                        <el-option                                                v-for="item in courseList"                                                :key="item.id"                                                :label="item.name"                                                :value="item.id">                                        </el-option>                                    </el-select>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row>                            <el-col :span="24">                                <el-form-item label="题目题干：" prop="question">                                    <el-input v-model="formData.question" type="textarea"></el-input>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row>                            <el-col :span="24">                                <el-form-item label="题目选项：">                                    <el-col :span="21">                                        <el-input                                                v-model="newOption"                                                id="new-todo"                                                placeholder="选项内容"                                        ></el-input>                                    </el-col>                                    <el-button @click="addNewOption()" class="dalfBut">添加</el-button>                                </el-form-item>                            </el-col>                        </el-row>                        <!--测试-->                        <el-table size="small" current-row-key="Id" :data="todos" stripe highlight-current-row>                            <el-table-column prop="Id" width="60px" align="center" label="序号"></el-table-column>                            <el-table-column prop="answer" align="center" label="选项内容"></el-table-column>                        </el-table>                        <el-row>                            <el-form-item label="正确答案：" prop="realAnswer">                                <el-select v-model="formData.realAnswer">                                    <el-option                                            v-for="item in todos"                                            :key="item.Id"                                            :label="item.answer"                                            :value="item.Id">                                    </el-option>                                </el-select>                            </el-form-item>                        </el-row>                        <el-row>                            <el-col :span="24">                                <el-form-item label="题目解析：">                                    <el-input v-model="formData.analysis" type="textarea"></el-input>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleAdd()">确定</el-button>                    </div>                </el-dialog>            </div>            <!-- 编辑标签弹层 -->            <div class="add-form">                <el-dialog title="编辑检查项" :visible.sync="dialogFormVisible4Edit">                    <el-form ref="dataEditForm" :model="formData" :rules="rules" label-position="right" label-width="100px">                        <el-row>                            <el-col :span="12">                                <el-form-item label="所属课程：" prop="courseId">                                    <el-select v-model="formData.courseId">                                        <el-option                                                v-for="item in courseList"                                                :key="item.id"                                                :label="item.name"                                                :value="item.id">                                        </el-option>                                    </el-select>                                </el-form-item>                            </el-col>                            <el-col :span="12">                                <el-select placeholder="出题人" v-model="pagination.teacherId" disabled >                                    <el-option                                            v-for="item in teacherList"                                            :key="item.id"                                            :label="item.name"                                            :value="item.id">                                    </el-option>                                </el-select>                            </el-col>                        </el-row>                        <el-row>                            <el-col :span="24">                                <el-form-item label="题目题干：">                                    <el-input v-model="formData.question" type="textarea"></el-input>                                </el-form-item>                            </el-col>                        </el-row>                        <el-row>                            <el-form-item label="正确答案：" prop="realAnswer">                                <el-select v-model="formData.realAnswer">                                    <el-option                                            v-for="item in todos"                                            :key="item.id"                                            :label="item.answer"                                            :value="item.id">                                    </el-option>                                </el-select>                            </el-form-item>                        </el-row>                        <el-row>                            <el-col :span="24">                                <el-form-item label="题目解析：">                                    <el-input v-model="formData.analysis" type="textarea"></el-input>                                </el-form-item>                            </el-col>                        </el-row>                    </el-form>                    <div slot="footer" class="dialog-footer">                        <el-button @click="cancel()">取消</el-button>                        <el-button type="primary" @click="handleEdit()">确定</el-button>                    </div>                </el-dialog>            </div>        </div>    </div></div></body><!-- 引入组件库 -->    <script src="/static/js/vue.js"></script>    <script src="/static/ElementUI/index.js"></script>    <script type="text/javascript" src="/static/js/jquery-3.6.0.js"></script>    <script src="/static/js/axois.js"></script><script>    var vue = new Vue({        el: '#app',        data:{            dataList: [],//当前页要展示的列表数据            courseList: [],            teacherList: [],            dialogFormVisible: false,//添加表单是否可见            dialogFormVisible4Edit:false,//编辑表单是否可见            formData: {                realAnswer: "",                answerList: ""            },            answerList: [],            //表单数据            rules: {//校验规则                courseId: [{ required: true, message: '课程号为必填项', trigger: 'blur' }],                question: [{ required: true, message: '题干为必填项', trigger: 'blur' }],                realAnswer: [{ required: true, message: '答案为必填项', trigger: 'blur' }]            },            pagination: {//分页相关模型数据                currentPage: 1,//当前页码                pageSize:6,//每页显示的记录数                total:0,//总记录数                question:"",                id:"",                courseId:"",                teacherId:""            },            newOption: '',            todos: [            ],            nextTodoId: 1        },        //钩子函数，VUE对象初始化完成后自动执行        created() {            this.getAllCourse();            this.getAllTeacher();            this.getAll();        },        methods: {            addNewOption() {                this.todos.push({                    Id: this.nextTodoId++,                    answer: this.newOption                })                this.newOption = ''            },            resetSearchForm(){                vue.pagination.id="";                vue.pagination.question="";                vue.pagination.courseId="";                vue.pagination.teacherId="";            },            //列表            //分页查询            getAll() {                // console.log(this.pagination.type);                param="?id="+this.pagination.id;                param+="&question="+this.pagination.question;                param+="&courseId="+this.pagination.courseId;                param+="&teacherId="+this.pagination.teacherId;                //发送异步请求                axios.get("/question/getPage/"+this.pagination.currentPage+"/"+this.pagination.pageSize+param).then((res)=>{                    this.pagination.currentPage=res.data.data.current;                    this.pagination.pagesize=res.data.data.size;                    this.pagination.total=res.data.data.total;                    this.dataList=res.data.data.records;                });            },            getAllCourse(){                axios.get("/course/getAll").then((res)=>{                    this.courseList=res.data;                })            },            getAllTeacher(){                axios.get("/teachers/getTeacherAll").then((res)=>{                    this.teacherList=res.data;                })            },            //切换页码            handleCurrentChange(currentPage) {                this.pagination.currentPage=currentPage;                this.getAll();            },            //弹出添加窗口            handleCreate() {                this.dialogFormVisible=true;                this.resetForm();            },            //重置表单            resetForm() {                this.formData= {};                this.todos=[];                this.nextTodoId=1            },            //添加            handleAdd () {                this.formData.answerList=this.todos                console.log(this.formData.answerList)                axios.post("/question/save",this.formData).then((res)=>{                    //判断添加是否成功                    if(res.data.code==200){                        this.$message.success("添加成功！");                        this.todos=[];                        this.formData.question="";                        this.formData.realAnswer="";                        this.nextTodoId=1;                        this.formData.analysis="";                    }                    else {                        this.$message.error("失败");                    }                }).finally(()=>{                    this.getAll();                });            },            //取消            cancel(){                this.dialogFormVisible=false;                this.dialogFormVisible4Edit=false;                this.$message.success("取消成功");            },            // 删除            handleDelete(row) {                // console.log(row);                this.$confirm("是否删除","提示",{type:"info"}).then(()=>{                    console.log("success!");                    axios.delete("/question/deleteById/"+row.id).then((res)=>{                        if (res.data.code==200){                            this.$message.success("删除成功");                        }                        else {                            this.$message.error("删除失败");                        }                    }).finally(()=>this.getAll());                }).catch(()=>{                    console.log("cancel");                })            },            //弹出编辑窗口            handleUpdate(row) {                this.resetForm();                this.dialogFormVisible4Edit=true;                axios.get("/question/getById/"+row.id).then((res)=>{                    if(res.data.code==200 && res.data.data!=null){                        this.formData=res.data.data;                        this.todos=res.data.data.answerList;                    }                    else {                        this.$message.error("同步失败");                    }                }).finally(()=>{                    this.getAll();                })            },            //修改            handleEdit() {                axios.put("/question/update",this.formData).then((res)=>{                    if (res.data.code==200){                        this.$message.success("修改成功");                        this.dialogFormVisible4Edit=false;                    }                    else{                        this.$message.error("修改失败");                    }                }).finally(()=>{                    this.getAll();                })            },        },    })</script></html>